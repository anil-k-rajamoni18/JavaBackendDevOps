# Monitoring, Logging & Debugging 🩺📊

Kubernetes provides powerful observability tools to monitor, log, and debug workloads. These insights are essential for keeping applications healthy and performant.

---

## 📋 Logging & Monitoring Basics in Kubernetes

Logging and monitoring in Kubernetes help you:
- Understand system behavior over time ⏳
- Detect anomalies 🛑
- Investigate performance or availability issues 🔍

### 🧠 Key Concepts:
- **Logs** are generated by pods and nodes.
- **Metrics** reflect system health like CPU/memory usage.
- Logs are ephemeral; centralized logging is key.

### 🌍 Real-world Example:
An e-commerce platform uses metrics to autoscale services during flash sales and logs to trace order issues.

![Logging and Monitoring Basics](https://d33wubrfki0l68.cloudfront.net/4b9a591eaa07db03a457b1fd225ee773674d0fd7/09f9b/images/docs/monitoring-overview.png)

---

## 📈 Setting up Prometheus & Grafana for Metrics

Prometheus scrapes metrics from Kubernetes objects, and Grafana visualizes them through dashboards.

### 🔧 Setup Flow:
1. Deploy **Prometheus Operator**
2. Configure **ServiceMonitors** to scrape metrics
3. Connect Prometheus to **Grafana**

### 📸 Prometheus Deployment Example:
```yaml
apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  name: my-service-monitor
spec:
  selector:
    matchLabels:
      app: my-app
  endpoints:
  - port: web
```

### 🌍 Real-world Example:
A ride-sharing app uses Grafana dashboards to visualize trip volume and latency by city.

![Grafana Dashboard](https://grafana.com/static/img/docs/grafana-dashboard-example.png)

---

## 🪵 Fluentd, ELK Stack for Centralized Logging

Centralized logging stacks capture, parse, and store logs from all Kubernetes pods.

### 🔧 Components:
- **Fluentd**: Log aggregator
- **Elasticsearch**: Search and storage engine
- **Kibana**: Visualization UI

### 📸 Fluentd DaemonSet Example:
```yaml
apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: fluentd
spec:
  selector:
    matchLabels:
      name: fluentd
  template:
    metadata:
      labels:
        name: fluentd
    spec:
      containers:
      - name: fluentd
        image: fluent/fluentd:v1.14-1
        volumeMounts:
        - name: varlog
          mountPath: /var/log
      volumes:
      - name: varlog
        hostPath:
          path: /var/log
```

### 🌍 Real-world Example:
A streaming service uses the ELK stack to analyze 500k+ log lines per second for performance and security auditing.

![ELK Stack](https://logz.io/wp-content/uploads/2019/03/ELK-Stack-Architecture-Diagram.png)

---

## 🐞 Debugging Applications in Kubernetes

Debugging involves inspecting failing pods, checking events, or entering containers.

### 🔍 Key Tools:
- `kubectl describe pod` → Inspect pod events
- `kubectl get events` → See cluster-wide issues
- `kubectl get pod -o wide` → Debug scheduling issues

### 🌍 Real-world Example:
A payment gateway identifies failed card transactions by inspecting crashlooping pods and pod events.

---

## 🛠️ Using kubectl logs & exec for Troubleshooting

### 📜 `kubectl logs`:
Used to view logs from containers.
```bash
kubectl logs my-pod
kubectl logs -f my-pod -c my-container
```

### 🧳 `kubectl exec`:
Used to execute commands in running containers.
```bash
kubectl exec -it my-pod -- /bin/bash
```

### 🌍 Real-world Example:
DevOps engineers run `kubectl exec` to explore misconfigured environment variables causing login failures in production.

![Debugging Tools](https://kubernetes.io/images/docs/kubectl-debug-illustration.png)

---

## 📌 Summary
| Feature         | Tooling           | Benefit                              |
|------------------|--------------------|----------------------------------------|
| Logging          | Fluentd, ELK Stack | View application and system logs       |
| Monitoring       | Prometheus, Grafana| Track CPU, memory, custom metrics      |
| Debugging        | kubectl tools      | Root cause analysis and live debugging |

---

## 📚 Reference Documentation
- [Kubernetes Monitoring Overview](https://kubernetes.io/docs/tasks/debug/debug-cluster/resource-metrics-pipeline/)
- [Prometheus Operator](https://github.com/prometheus-operator/prometheus-operator)
- [Grafana](https://grafana.com/docs/)
- [Fluentd](https://docs.fluentd.org/)
- [ELK Stack](https://www.elastic.co/what-is/elk-stack)
- [kubectl Troubleshooting](https://kubernetes.io/docs/tasks/debug/debug-application/)

---

